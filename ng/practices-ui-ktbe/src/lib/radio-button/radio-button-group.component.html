<div *ngIf="!(isReadonly$ | async); else readonly" class="relative mt-5">
    <div
        [ngClass]="{
            'flex justify-between border py-4 pl-7 pr-4': !hideGroupBorder,
            'border-red': !hideGroupBorder && (displayAsInvalid$ | async),
            'border-dark-gray-50': !hideGroupBorder && !(displayAsInvalid$ | async)
        }"
    >
        <fieldset>
            <legend *ngIf="!legendAsLabel" class="my-[0.625rem] block text-base font-medium">
                <span [ngClass]="{ 'sr-only': isLegendSrOnly }">{{ legend }}</span>
                <span class="sr-only">{{ hint }}</span>
            </legend>
            <legend
                *ngIf="legendAsLabel"
                class="text-very-small absolute -top-5 left-6 translate-y-2 rounded-lg bg-white px-1 py-0.5"
                [class.text-red]="displayAsInvalid$ | async"
                [class.opacity-0]="hideGroupBorder"
            >
                <span [ngClass]="{ 'sr-only': isLegendSrOnly }">{{ legend }}</span>
            </legend>

            <div
                class="flex flex-wrap"
                [ngClass]="{
                    'flex-col': displayInline === false,
                    'gap-5': displayInline === false && gapVariant === 'large'
                }"
            >
                <ng-content select="puibe-radio-button"></ng-content>
                <ng-content></ng-content>
            </div>
            <div *ngIf="hint" class="mb-2 mt-4 text-base font-light leading-tight" aria-hidden="true">
                {{ hint }}
            </div>
        </fieldset>
        <div class="ml-2 flex" aria-hidden="true" *ngIf="!hideGroupBorder">
            <puibe-icon-invalid class="h-8 w-8" *ngIf="displayAsInvalid$ | async"></puibe-icon-invalid>
            <puibe-icon-spinner class="h-8 w-8" *ngIf="pending$ | async"></puibe-icon-spinner>
        </div>
    </div>
    <span
        class="text-very-small absolute -top-5 right-3 translate-y-2 rounded-lg bg-white px-1 py-0.5"
        [class.text-red]="displayAsInvalid$ | async"
        *ngIf="!hideGroupBorder && (isOptional$ | async)"
        aria-hidden="true"
    >
        {{ 'Practices.Labels_Optional' | translate }}
    </span>
    <div
        [attr.id]="(name$ | async) + '-error'"
        class="text-red text-very-small min-h-5 font-medium"
        [attr.aria-live]="(dirty$ | async) ? 'assertive' : 'off'"
        aria-atomic="true"
    >
        <div *ngFor="let error of errors$ | async">
            {{ error.key | translate : error.param }}
        </div>
    </div>
    <span class="sr-only" aria-live="polite" aria-atomic="true">
        <span *ngIf="pending$ | async">{{ 'Practices.Labels_Pending' | translate }}</span>
    </span>
</div>
<ng-template #readonly>
    <puibe-readonly-label-value [label]="legend" [useSmallLabel]="useSmallTextForReadonlyLabel">
        <ng-container *ngIf="labelOfSelectedRadio$ | async as label; else noEntry">
            <span *ngIf="label !== ''">{{ label }}</span>
            <span *ngIf="label === ''">{{
                readonlyEmptyValuePlaceholder ?? ('Practices.Labels_Input_NoInputValue' | translate)
            }}</span>
        </ng-container>

        <ng-template #noEntry>
            {{ readonlyEmptyValuePlaceholder ?? ('Practices.Labels_Input_NoInputValue' | translate) }}
        </ng-template>
    </puibe-readonly-label-value>
</ng-template>
