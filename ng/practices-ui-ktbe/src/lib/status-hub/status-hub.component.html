<div role="status" aria-live="polite">
    <div
        *ngIf="busyAndBlocking$ | async as busyAndBlocking"
        @slowFadeAnimation
        class="bg-dark-gray-50-solid fixed left-0 top-0 z-[1002] flex h-screen w-screen items-center justify-center bg-opacity-10 align-middle backdrop-blur-sm"
    ></div>

    <ng-container *ngIf="progressMessage$ | async as message; else noMessage">
        <div
            *ngIf="busyAndBlocking$ | async as busyAndBlocking"
            class="fixed bottom-10 left-10 right-10 top-10 z-[1002] flex items-center justify-center align-middle"
        >
            <ng-container *ngTemplateOutlet="progressMessageTmpl; context: { $implicit: message }"></ng-container>
        </div>
    </ng-container>
    <ng-template #noMessage>
        <span *ngIf="busyAndBlocking$ | async" class="sr-only" role="status" translate>Practices.Labels_Pending</span>
    </ng-template>
</div>
<div
    *ngIf="busyNoMessage$ | async as busy"
    @scaleAnimation
    class="pointer-events-none fixed bottom-0 left-0 z-50 flex w-screen justify-center align-middle"
    [ngClass]="{ 'h-screen': busyAndBlocking$ | async, 'h-20': !(busyAndBlocking$ | async) }"
>
    <puibe-icon-spinner [size]="IconSize.L" class="flex"></puibe-icon-spinner>
</div>
<div
    class="fixed z-[1002] m-auto flex w-fit flex-col justify-start overflow-visible bg-none align-middle md:gap-2"
    [ngClass]="positionClasses"
    aria-live="polite"
    role="status"
>
    <puibe-status-toast
        *ngFor="let status of statusToasts$ | async; trackBy: trackByFn"
        [errorTemplate]="statusError?.templateRef"
        @listEntryAnimation
        class="drop-shadow-md"
        [status]="status"
        (dismissed)="dismissed.emit(status)"
    ></puibe-status-toast>
    <ng-content select="puibe-status-toast, puibe-toast"></ng-content>
    <ng-container *ngIf="progressMessage$ | async as message">
        <ng-container *ngIf="!(busyAndBlocking$ | async)">
            <ng-container *ngTemplateOutlet="progressMessageTmpl; context: { $implicit: message }"></ng-container>
        </ng-container>
    </ng-container>
</div>

<ng-template #progressMessageTmpl let-message>
    <puibe-toast
        variant="info"
        @listEntryAnimation
        [closeable]="false"
        class="flex min-w-full max-w-full items-center justify-center overflow-hidden drop-shadow-md max-sm:max-w-full sm:max-w-[660px] md:min-w-[300px]"
    >
        <div class="flex items-center justify-between gap-2">
            <span class="flex-auto whitespace-pre-wrap">{{ message }}</span>
            <puibe-icon-spinner @scaleAnimation [size]="IconSize.M" class="inline-flex"></puibe-icon-spinner>
        </div>
    </puibe-toast>
</ng-template>
<ng-content select="[puibeIfErrorStatus]"></ng-content>
