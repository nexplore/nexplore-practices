jobs:
    - job: Build
      displayName: Build & Test
      workspace:
          clean: outputs
      steps:
          - checkout: self
            clean: false

          - task: UseDotNet@2
            displayName: 'Prepare global .NET Environment'
            inputs:
               useGlobalJson: true
               workingDirectory: 'dotnet'

          - task: UseDotNet@2
            displayName: 'Prepare .NET 8 Environment'
            inputs:
                version: '8.x'

          - task: UseNode@1
            displayName: 'Prepare Node.js Environment'
            inputs:
                version: '22.14.0'

          - task: CmdLine@2
            displayName: Run Build
            inputs:
                script: ./build.sh BuildPackAll

          - task: PublishBuildArtifacts@1
            displayName: Publish Artifacts
            inputs:
                PathtoPublish: .nuke/temp/output
            condition: always()
